# findme

## Overview

- Overall difficulty for me (From 1-10 stars): ★☆☆☆☆☆☆☆☆☆

## Background

Author: Geoffrey Njogu

Description

Help us test the form by submiting the username as `test` and password as `test!`

The website running [here](http://saturn.picoctf.net:64526/).

## Enumeration

**Home page:**

![](https://github.com/siunam321/CTF-Writeups/blob/main/picoCTF-2023/images/Pasted%20image%2020230315195448.png)

In here, we see there's a login page!

**Let's try `test:test`:**

![](https://github.com/siunam321/CTF-Writeups/blob/main/picoCTF-2023/images/Pasted%20image%2020230315195621.png)

![](https://github.com/siunam321/CTF-Writeups/blob/main/picoCTF-2023/images/Pasted%20image%2020230315195629.png)

**Nope. We need to try `test:test!`:**

![](https://github.com/siunam321/CTF-Writeups/blob/main/picoCTF-2023/images/Pasted%20image%2020230315195648.png)

![](https://github.com/siunam321/CTF-Writeups/blob/main/picoCTF-2023/images/Pasted%20image%2020230315195659.png)

Now, what I would like to do is fire up Burp Suite, and proxying ALL the HTTP traffics.

**Burp Suite HTTP history:**

![](https://github.com/siunam321/CTF-Writeups/blob/main/picoCTF-2023/images/Pasted%20image%2020230315195929.png)

When we click the "test" button, it'll send a POST request to `/login`, with parameter `username` and `password`.

If we're authenticated, it'll redirect us to ***`/next-page/id=cGljb0NURntwcm94aWVzX2Fs`***.

**`/next-page/id=cGljb0NURntwcm94aWVzX2Fs`:**

![](https://github.com/siunam321/CTF-Writeups/blob/main/picoCTF-2023/images/Pasted%20image%2020230315200055.png)

**In this page, it has a JavaScript code:**
```js
setTimeout(function () {
   // after 2 seconds
   window.location = "/next-page/id=bF90aGVfd2F5X2UzMWJiNzZkfQ==";
}, 0.5)
```

After 2 seconds, it'll set the `window` object's `location` attribute to `/next-page/id=bF90aGVfd2F5X2UzMWJiNzZkfQ==`, which is redirecting us to that page.

**`/next-page/id=bF90aGVfd2F5X2UzMWJiNzZkfQ==`:**

![](https://github.com/siunam321/CTF-Writeups/blob/main/picoCTF-2023/images/Pasted%20image%2020230315200219.png)

Then, it'll redirect us to `/home`.

**Hmm... I wonder what are those `id` GET parameter's value:**
```
cGljb0NURntwcm94aWVzX2FsbF90aGVfd2F5X2UzMWJiNzZkfQ==
```

In that string, there's a `=` character, which is a base64 encoding's padding string.

***Armed with above information, we can base64 decode it:***
```shell
┌[siunam♥earth]-(~/ctf/picoCTF-2023)-[2023.03.15|19:57:49(HKT)]
└> echo 'cGljb0NURntwcm94aWVzX2FsbF90aGVfd2F5X2UzMWJiNzZkfQ==' | base64 -d
picoCTF{proxies_all_the_way_e31bb76d}
```

Boom! We got the flag!

- **Flag: `picoCTF{proxies_all_the_way_e31bb76d}`**

## Conclusion

What we've learned:

1. Proxying HTTP Traffics